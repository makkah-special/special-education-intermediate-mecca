<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨ÙˆØ§Ø¨Ø© Ù…Ø´Ø±Ù ÙŠØ³ÙŠØ± | Ù…Ø¯Ø±Ø³Ø© Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800;900&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #1a3a5c;
    --accent: #c8973a;
    --accent-light: #f0b84a;
    --green: #1a6b4a;
    --green-light: #22a06b;
    --bg: #f5f2eb;
    --card: #ffffff;
    --border: #e0d8c8;
    --text: #1a1a2e;
    --muted: #5a6478;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Cairo',sans-serif; background:var(--bg); color:var(--text); min-height:100vh; }

  header { background:linear-gradient(135deg,var(--primary) 0%,#0f2448 60%,#1a3a5c 100%); position:relative; }
  header::after { content:''; position:absolute; bottom:0; left:0; right:0; height:4px; background:linear-gradient(90deg,var(--accent),var(--accent-light),var(--accent)); }
  .header-top { display:flex; align-items:center; justify-content:space-between; padding:16px 40px; border-bottom:1px solid rgba(255,255,255,0.08); }
  .header-logos { display:flex; align-items:center; gap:14px; }
  .logo-icon { width:52px; height:52px; border-radius:50%; background:rgba(255,255,255,0.12); border:2px solid rgba(200,151,58,0.4); display:flex; align-items:center; justify-content:center; font-size:22px; }
  .header-name { color:rgba(255,255,255,0.9); font-size:0.83rem; font-weight:600; }
  .header-sub { color:rgba(255,255,255,0.5); font-size:0.75rem; }
  .back-link { background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:rgba(255,255,255,0.85); padding:7px 16px; border-radius:8px; text-decoration:none; font-size:0.82rem; font-weight:600; transition:all 0.2s; }
  .back-link:hover { background:rgba(255,255,255,0.18); }
  .hero { padding:36px 40px 44px; text-align:center; }
  .hero-badge { display:inline-block; background:rgba(200,151,58,0.15); border:1px solid rgba(200,151,58,0.35); color:var(--accent-light); padding:5px 18px; border-radius:20px; font-size:0.8rem; font-weight:600; margin-bottom:14px; }
  .hero h1 { font-family:'Tajawal',sans-serif; font-size:clamp(1.6rem,4vw,2.2rem); font-weight:900; color:#fff; margin-bottom:6px; }
  .hero h1 span { color:var(--accent-light); }
  .hero p { color:rgba(255,255,255,0.6); font-size:0.88rem; }

  /* PIN */
  .pin-screen { display:flex; align-items:center; justify-content:center; min-height:60vh; padding:20px; }
  .pin-box { background:var(--card); border-radius:20px; padding:40px 32px; max-width:360px; width:100%; text-align:center; box-shadow:0 8px 40px rgba(0,0,0,0.1); }
  .pin-icon { font-size:2.6rem; margin-bottom:14px; }
  .pin-title { font-family:'Tajawal',sans-serif; font-size:1.3rem; font-weight:900; color:var(--primary); margin-bottom:6px; }
  .pin-desc { font-size:0.83rem; color:var(--muted); margin-bottom:22px; line-height:1.7; }
  .pin-input { width:100%; padding:13px; border:2px solid var(--border); border-radius:11px; font-family:'Cairo',sans-serif; font-size:1.3rem; font-weight:700; text-align:center; letter-spacing:8px; outline:none; transition:all 0.2s; background:#fafafa; margin-bottom:10px; }
  .pin-input:focus { border-color:var(--primary); background:#fff; }
  .pin-input.error { border-color:#ef4444; animation:shake 0.4s ease; }
  @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-8px)} 75%{transform:translateX(8px)} }
  .pin-error { display:none; color:#dc2626; font-size:0.8rem; font-weight:700; margin-bottom:10px; background:#fee2e2; padding:7px 12px; border-radius:8px; }
  .pin-error.show { display:block; }
  .btn-enter { width:100%; padding:13px; background:linear-gradient(135deg,var(--primary),#2563a8); color:#fff; border:none; border-radius:10px; font-family:'Cairo',sans-serif; font-size:0.95rem; font-weight:800; cursor:pointer; box-shadow:0 4px 14px rgba(26,58,92,0.3); transition:all 0.2s; }
  .btn-enter:hover { transform:translateY(-2px); }

  /* CONTENT */
  .content { display:none; }
  main { max-width:960px; margin:0 auto; padding:26px 22px 60px; }

  .stats-row { display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:14px; margin-bottom:22px; }
  .stat-card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:18px; text-align:center; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
  .stat-num { font-family:'Tajawal',sans-serif; font-size:2rem; font-weight:900; color:var(--primary); }
  .stat-label { font-size:0.75rem; color:var(--muted); font-weight:600; margin-top:4px; }

  .toolbar { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px 18px; margin-bottom:18px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
  .search-input { flex:1; min-width:180px; padding:8px 14px; border:1.5px solid var(--border); border-radius:8px; font-family:'Cairo',sans-serif; font-size:0.84rem; outline:none; background:#fafafa; }
  .search-input:focus { border-color:var(--primary); }
  .btn-refresh { padding:8px 16px; background:var(--primary); color:#fff; border:none; border-radius:8px; font-family:'Cairo',sans-serif; font-size:0.82rem; font-weight:700; cursor:pointer; transition:all 0.2s; }
  .btn-refresh:hover { background:#2563a8; }

  .sigs-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:16px; }
  .sig-card { background:var(--card); border:1px solid var(--border); border-radius:14px; overflow:hidden; box-shadow:0 2px 10px rgba(0,0,0,0.05); transition:all 0.2s; }
  .sig-card:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,0,0,0.1); }
  .sig-head { padding:14px 16px; background:linear-gradient(135deg,#f0f4ff,#e8f0ff); border-bottom:1px solid var(--border); display:flex; align-items:center; gap:10px; }
  .sig-avatar { width:38px; height:38px; background:var(--primary); border-radius:10px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:1rem; font-weight:800; flex-shrink:0; }
  .sig-name { font-size:0.88rem; font-weight:800; color:var(--primary); }
  .sig-grade { font-size:0.74rem; color:var(--muted); margin-top:2px; }
  .sig-img-wrap { padding:12px 16px; background:#f9f9f9; border-bottom:1px solid var(--border); height:100px; display:flex; align-items:center; justify-content:center; }
  .sig-img-wrap img { max-height:88px; max-width:100%; object-fit:contain; }
  .sig-foot { padding:10px 16px; display:flex; align-items:center; justify-content:space-between; }
  .sig-date { font-size:0.73rem; color:var(--muted); }
  .sig-badge { background:#d1fae5; color:#065f46; padding:3px 10px; border-radius:10px; font-size:0.72rem; font-weight:700; }

  .sig-actions { display:flex; gap:8px; padding:10px 16px; background:#f8f8f8; border-top:1px solid var(--border); }
  .btn-dl-png { flex:1; padding:7px; background:#e8f0ff; color:#1e40af; border:1px solid #bfdbfe; border-radius:8px; font-family:'Cairo',sans-serif; font-size:0.78rem; font-weight:700; cursor:pointer; transition:all 0.2s; }
  .btn-dl-png:hover { background:#bfdbfe; }
  .btn-dl-pdf { flex:1; padding:7px; background:#d1fae5; color:#065f46; border:1px solid #6ee7b7; border-radius:8px; font-family:'Cairo',sans-serif; font-size:0.78rem; font-weight:700; cursor:pointer; transition:all 0.2s; }
  .btn-dl-pdf:hover { background:#6ee7b7; }
  .btn-dl-del { flex:1; padding:7px; background:#fee2e2; color:#dc2626; border:1px solid #fca5a5; border-radius:8px; font-family:'Cairo',sans-serif; font-size:0.78rem; font-weight:700; cursor:pointer; transition:all 0.2s; }
  .btn-dl-del:hover { background:#dc2626; color:#fff; }

  .empty-state { text-align:center; padding:60px 20px; color:var(--muted); }
  .empty-icon { font-size:3rem; margin-bottom:12px; }

  .loading-spinner { text-align:center; padding:40px; color:var(--muted); font-size:0.9rem; }

  footer { background:var(--primary); color:rgba(255,255,255,0.65); text-align:center; padding:20px 40px; font-size:0.8rem; border-top:3px solid var(--accent); margin-top:40px; }
  footer strong { color:var(--accent-light); }

  @media(max-width:640px) {
    .header-top { padding:12px 16px; }
    .hero { padding:28px 16px 34px; }
    main { padding:16px 14px 40px; }
  }
</style>
</head>
<body>

<header>
  <div class="header-top">
    <div class="header-logos">
      <div class="logo-icon">âœï¸</div>
      <div>
        <div class="header-name">Ù…Ø¯Ø±Ø³Ø© Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© â€” Ø¨ÙˆØ§Ø¨Ø© Ù…Ø´Ø±Ù ÙŠØ³ÙŠØ±</div>
        <div class="header-sub">Ù‚Ø³Ù… Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø© â€” Ø³Ø¬Ù„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</div>
      </div>
    </div>
    <a href="upload-reports.html" class="back-link" style="background:rgba(200,151,58,0.2);border-color:rgba(200,151,58,0.4);color:var(--accent-light);">ğŸ“¤ Ø±ÙØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
    <a href="index.html" class="back-link">â† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  </div>
  <div class="hero">
    <div class="hero-badge">âœï¸ Ø³Ø¬Ù„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</div>
    <h1>Ø¥Ù‚Ø±Ø§Ø±Ø§Øª <span>Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</span></h1>
    <p>Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ù† Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</p>
  </div>
</header>

<!-- PIN SCREEN -->
<div class="pin-screen" id="pin-screen">
  <div class="pin-box">
    <div class="pin-icon">ğŸ”</div>
    <div class="pin-title">ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</div>
    <div class="pin-desc">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…Ø´Ø±Ù Ù„Ø¹Ø±Ø¶ Ø³Ø¬Ù„ ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</div>
    <input type="password" class="pin-input" id="admin-pin" maxlength="6" placeholder="â€¢ â€¢ â€¢ â€¢"
      onkeydown="if(event.key==='Enter') checkPin()"
      oninput="this.value=this.value.replace(/[^0-9]/g,'')">
    <div class="pin-error" id="pin-error">âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­</div>
    <button class="btn-enter" onclick="checkPin()">âœ… Ø¯Ø®ÙˆÙ„</button>
  </div>
</div>

<!-- CONTENT -->
<div class="content" id="content">
  <main>
    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-num" id="stat-total">0</div>
        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</div>
      </div>
      <div class="stat-card">
        <div class="stat-num" id="stat-today">0</div>
        <div class="stat-label">ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
      </div>
      <div class="stat-card">
        <div class="stat-num" id="stat-students">0</div>
        <div class="stat-label">Ø·Ù„Ø§Ø¨ ÙˆÙ‚Ù‘Ø¹ÙˆØ§</div>
      </div>
    </div>

    <div class="toolbar">
      <input type="text" class="search-input" id="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ù„ØµÙ..." oninput="filterSigs()">
      <button class="btn-refresh" onclick="loadSignatures()">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
    </div>

    <div id="sigs-container">
      <div class="loading-spinner">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
  </main>
</div>

<footer>
  Â© 1447Ù‡Ù€ Ù…Ø¯Ø±Ø³Ø© Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© â€” Ù‚Ø³Ù… Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø©<br>
  <strong>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ†ÙÙŠØ°: Ø£. Ø³Ø¹Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</strong>
</footer>

<script>
const SUPABASE_URL = "https://pyrxwqgapwjwhiskowhk.supabase.co";
const SUPABASE_KEY = "sb_publishable_bfe-B4f-Rag1SR0-PoIb9w_nMfA1Ere";
const ADMIN_PIN    = "1129";

let allSigs = [];

function checkPin() {
  const val = document.getElementById('admin-pin').value;
  if (val === ADMIN_PIN) {
    document.getElementById('pin-screen').style.display = 'none';
    document.getElementById('content').style.display = 'block';
    loadSignatures();
  } else {
    const err = document.getElementById('pin-error');
    const inp = document.getElementById('admin-pin');
    err.classList.add('show');
    inp.classList.add('error');
    inp.value = '';
    setTimeout(() => inp.classList.remove('error'), 500);
  }
}

async function loadSignatures() {
  document.getElementById('sigs-container').innerHTML = '<div class="loading-spinner">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  try {
    const res = await fetch(`${SUPABASE_URL}/rest/v1/signatures?order=signed_at.desc`, {
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': 'Bearer ' + SUPABASE_KEY
      }
    });
    allSigs = await res.json();
    updateStats();
    renderSigs(allSigs);
  } catch(e) {
    document.getElementById('sigs-container').innerHTML = '<div class="empty-state"><div class="empty-icon">âŒ</div><p>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p></div>';
  }
}

function updateStats() {
  document.getElementById('stat-total').textContent = allSigs.length;
  const today = new Date().toDateString();
  const todayCount = allSigs.filter(s => new Date(s.signed_at).toDateString() === today).length;
  document.getElementById('stat-today').textContent = todayCount;
  const unique = new Set(allSigs.map(s => s.student_pin)).size;
  document.getElementById('stat-students').textContent = unique;
}

function renderSigs(sigs) {
  const container = document.getElementById('sigs-container');
  if (!sigs.length) {
    container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“­</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯</p></div>';
    return;
  }
  container.innerHTML = `<div class="sigs-grid">${sigs.map(s => {
    const date = new Date(s.signed_at).toLocaleDateString('ar-SA-u-nu-latn', {
      year:'numeric', month:'short', day:'numeric', hour:'2-digit', minute:'2-digit'
    });
    const initial = s.student_name ? s.student_name.split(' ').map(w=>w[0]).join('').slice(0,2) : 'ØŸ';
    const idx = sigs.indexOf(s);
    return `
      <div class="sig-card">
        <div class="sig-head">
          <div class="sig-avatar">${initial}</div>
          <div>
            <div class="sig-name">${s.student_name || 'â€”'}</div>
            <div class="sig-grade">${s.grade || 'â€”'}</div>
          </div>
        </div>
        <div class="sig-img-wrap">
          ${s.signature_data
            ? `<img src="${s.signature_data}" alt="Ø§Ù„ØªÙˆÙ‚ÙŠØ¹" id="sigimg-${idx}">`
            : '<span style="color:#9ca3af;font-size:0.8rem;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙ‚ÙŠØ¹</span>'}
        </div>
        <div class="sig-foot">
          <span class="sig-date">ğŸ“… ${date}</span>
          <span class="sig-badge">âœ… Ù…ÙˆÙ‚Ù‘Ø¹</span>
        </div>
        ${s.signature_data ? `
        <div class="sig-actions">
          <button class="btn-dl-png" onclick="downloadPNG('${s.signature_data}', '${s.student_name}')">â¬‡ï¸ ØµÙˆØ±Ø©</button>
          <button class="btn-dl-pdf" onclick="downloadPDF(${idx})">ğŸ–¨ï¸ PDF</button>
          <button class="btn-dl-del" onclick="deleteSig(${s.id}, '${s.student_name}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        </div>` : ''}
      </div>
    `;
  }).join('')}</div>`;
}

function filterSigs() {
  const q = document.getElementById('search-input').value.trim().toLowerCase();
  if (!q) { renderSigs(allSigs); return; }
  const filtered = allSigs.filter(s =>
    (s.student_name||'').includes(q) || (s.grade||'').includes(q)
  );
  renderSigs(filtered);
}

async function deleteSig(id, name) {
  if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ØªÙˆÙ‚ÙŠØ¹ "${name}"ØŸ`)) return;
  try {
    const res = await fetch(`${SUPABASE_URL}/rest/v1/signatures?id=eq.${id}`, {
      method: 'DELETE',
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': 'Bearer ' + SUPABASE_KEY
      }
    });
    if (res.ok) {
      allSigs = allSigs.filter(s => s.id !== id);
      updateStats();
      filterSigs();
    } else {
      alert('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù');
    }
  } catch(e) {
    alert('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + e.message);
  }
}

function downloadPNG(dataUrl, name) {
  const a = document.createElement('a');
  a.href = dataUrl;
  a.download = `ØªÙˆÙ‚ÙŠØ¹_${name || 'ÙˆÙ„ÙŠ_Ø§Ù„Ø£Ù…Ø±'}.png`;
  a.click();
}

function downloadPDF(idx) {
  const s = allSigs[idx];
  if (!s) return;
  const dateObj = new Date(s.signed_at);
  const date = dateObj.toLocaleDateString('ar-SA-u-nu-latn', {
    year:'numeric', month:'long', day:'numeric', weekday:'long'
  });
  const time = dateObj.toLocaleTimeString('ar-SA-u-nu-latn', {
    hour:'2-digit', minute:'2-digit', hour12:true
  });
  const win = window.open('', '_blank');
  win.document.write(`
    <!DOCTYPE html>
    <html lang="ar" dir="rtl">
    <head>
      <meta charset="UTF-8">
      <title>Ø¥Ù‚Ø±Ø§Ø± â€” ${s.student_name}</title>
      <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Cairo',sans-serif; background:#fff; color:#1a1a2e; padding:40px; direction:rtl; }
        .header { text-align:center; margin-bottom:28px; border-bottom:3px solid #1a3a5c; padding-bottom:18px; }
        .school { font-size:0.78rem; color:#fff; background:#1a3a5c; display:inline-block; padding:4px 16px; border-radius:20px; margin-bottom:10px; }
        h1 { font-size:1.35rem; font-weight:900; color:#1a3a5c; margin-bottom:4px; }
        .sub { font-size:0.83rem; color:#5a6478; }
        .iqrar-text { background:#fffbf0; border:1px solid #f0d898; border-right:4px solid #c8973a; border-radius:10px; padding:16px 18px; margin:20px 0; font-size:0.88rem; line-height:2; }
        .fields { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin:18px 0; }
        .fields .field:last-child:nth-child(odd) { grid-column: span 2; }
        .field { border:1px solid #e0d8c8; border-radius:8px; padding:10px 14px; }
        .field-label { font-size:0.7rem; font-weight:700; color:#5a6478; margin-bottom:3px; }
        .field-value { font-size:0.88rem; font-weight:800; color:#1a3a5c; }
        .sign-section { margin-top:22px; }
        .sign-title { font-size:0.83rem; font-weight:700; color:#1a3a5c; margin-bottom:8px; }
        .sign-box { border:2px solid #1a3a5c; border-radius:10px; height:110px; display:flex; align-items:center; justify-content:center; overflow:hidden; }
        .sign-box img { max-height:100px; }
        .footer { margin-top:26px; text-align:center; font-size:0.72rem; color:#9ca3af; border-top:1px solid #e0d8c8; padding-top:12px; }
        @media print { body { padding:20px; } }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="school">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… â€” Ù…Ø¯Ø±Ø³Ø© Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©</div>
        <h1>Ø¥Ù‚Ø±Ø§Ø± Ø§Ø·Ù„Ø§Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ÙØ±Ø¯ÙŠØ©</h1>
        <div class="sub">Ù‚Ø³Ù… Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø© â€” Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠØ³ÙŠØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</div>
      </div>
      <div class="iqrar-text">
        Ø£Ù†Ø§ ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨ / <strong>${s.student_name}</strong>ØŒ Ø£ÙÙ‚Ø±Ù‘ Ø¨Ø£Ù†Ù†ÙŠ Ø§Ø·Ù„Ø¹ØªÙ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„ÙØ±Ø¯ÙŠØ© Ø§Ù„Ù…ÙØ¹Ø¯ÙÙ‘Ø© Ù„Ø§Ø¨Ù†ÙŠ
        Ù„Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ù† Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 1447Ù‡Ù€ØŒ ÙˆØ£Ù†Ù†ÙŠ Ø¹Ù„Ù‰ Ø¯Ø±Ø§ÙŠØ© Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠÙ‡Ø§ØŒ
        ÙˆØ£ØªØ¹Ù‡Ø¯ Ø¨Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ø§Ø¨Ù†ÙŠ.
      </div>
      <div class="fields">
        <div class="field"><div class="field-label">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</div><div class="field-value">${s.student_name}</div></div>
        <div class="field"><div class="field-label">Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</div><div class="field-value">${s.grade || 'â€”'}</div></div>
        <div class="field"><div class="field-label">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</div><div class="field-value">ğŸ“˜ Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠØ³ÙŠØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</div></div>
        <div class="field"><div class="field-label">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div><div class="field-value">${date}</div></div>
        <div class="field"><div class="field-label">ÙˆÙ‚Øª Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div><div class="field-value">${time}</div></div>
      </div>
      <div class="sign-section">
        <div class="sign-title">âœï¸ ØªÙˆÙ‚ÙŠØ¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</div>
        <div class="sign-box">
          ${s.signature_data
            ? `<img src="${s.signature_data}">`
            : '<span style="color:#9ca3af;font-size:0.8rem;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙ‚ÙŠØ¹</span>'}
        </div>
      </div>
      <div class="footer">Â© 1447Ù‡Ù€ â€” Ù…Ø¯Ø±Ø³Ø© Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© â€” Ù‚Ø³Ù… Ø°ÙˆÙŠ Ø§Ù„Ø¥Ø¹Ø§Ù‚Ø© â€” Ø¥Ø¹Ø¯Ø§Ø¯: Ø£. Ø³Ø¹Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ</div>
      <script>window.onload=()=>window.print();<\/script>
    </body>
    </html>
  `);
  win.document.close();
}
</script>
</body>
</html>
